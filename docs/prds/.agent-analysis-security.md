# Security Expert Analysis Request

**security-expert:** Analyze the FLUO codebase for production security readiness and identify all gaps that need PRDs.

## Analysis Required

### 1. Review Documented Gaps
- Read @docs/compliance-status.md for P0 security gaps
- Verify each documented gap against actual source code

### 2. Audit Backend Security Implementation
Check these specific files and report findings:
- `backend/src/main/java/com/fluo/compliance/telemetry/ComplianceSpanProcessor.java` - Is PII redaction enforced?
- `backend/src/main/java/com/fluo/services/DroolsRuleEngine.java` - Is rule sandboxing implemented?
- `backend/src/main/java/com/fluo/services/TenantSessionManager.java` - Is tenant isolation secure?
- `backend/src/main/java/com/fluo/compliance/evidence/` - Any cryptographic signing?
- Search for KMS integration code - does it exist?

### 3. Authentication & Authorization
- Search for WorkOS integration code in bff/src/
- Check if API endpoints in backend/src/main/java/com/fluo/routes/ have auth guards
- Look for JWT validation, session management
- Check for rate limiting, input validation

### 4. Data Security
- How is PII handled in logs and telemetry?
- Are secrets hardcoded anywhere?
- How are environment variables managed?
- Is there encryption at rest? In transit?

### 5. Multi-Tenancy Security
- Can tenants access each other's data?
- Are Drools sessions truly isolated?
- Check for tenant ID validation in API routes

## Output Format

For each security gap found:
1. **Gap Title** - Short description
2. **Current State** - What exists now (with file paths)
3. **Security Impact** - Why this is dangerous
4. **Required Solution** - What needs to be built
5. **Priority** - P0 (blocks production), P1 (high risk), P2 (medium risk)
6. **Complexity** - Simple/Medium/Complex
7. **Dependencies** - What else must exist first

Prioritize by: P0 first, then by complexity (simple first within same priority).

Be brutally honest - if code doesn't exist, say so. If it's aspirational documentation, call it out.
