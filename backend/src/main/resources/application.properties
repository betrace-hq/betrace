# FLUO Backend V2 Configuration

# Application settings
quarkus.application.name=fluo-backend-v2
quarkus.http.port=8080
quarkus.http.cors=true
quarkus.http.cors.origins=/.*/
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS

# WorkOS OAuth Configuration
# Replace these with your actual WorkOS credentials
workos.client.id=${WORKOS_CLIENT_ID:client_TEMP_WORKOS_CLIENT_ID}
workos.api.key=${WORKOS_API_KEY:sk_test_TEMP_WORKOS_SECRET_KEY}
workos.webhook.secret=${WORKOS_WEBHOOK_SECRET:whsec_TEMP_WEBHOOK_SECRET}
workos.redirect.uri=${WORKOS_REDIRECT_URI:http://localhost:8080/api/auth/callback}

# WorkOS SSO Configuration
workos.sso.enabled=true
workos.sso.default.organization=${WORKOS_DEFAULT_ORG:org_TEMP_DEFAULT_ORG}

# JWT Configuration for token validation
mp.jwt.verify.publickey.location=${JWT_PUBLIC_KEY:https://api.workos.com/.well-known/jwks.json}
mp.jwt.verify.issuer=${JWT_ISSUER:https://api.workos.com}
smallrye.jwt.sign.key.location=${JWT_SIGNING_KEY:/keys/privateKey.pem}

# Security Configuration
quarkus.security.auth.enabled-in-dev-mode=true
quarkus.http.auth.permission.authenticated.paths=/api/*
quarkus.http.auth.permission.authenticated.policy=authenticated
quarkus.http.auth.permission.public.paths=/api/auth/*,/health,/metrics
quarkus.http.auth.permission.public.policy=permit

# Role-based Access Control Mappings
# Define role requirements for different operations
fluo.security.roles.signal.read=signal:read,admin
fluo.security.roles.signal.write=signal:write,admin
fluo.security.roles.rule.read=rule:read,rule:write,admin
fluo.security.roles.rule.write=rule:write,admin
fluo.security.roles.span.write=span:write,telemetry:write,admin

# Tenant Isolation Configuration
fluo.security.tenant.isolation=true
fluo.security.tenant.header=X-Tenant-ID
fluo.security.tenant.validation.enabled=true

# Camel Configuration
camel.springboot.name=fluo-backend
camel.context.stream-caching.enabled=true
camel.rest.binding-mode=json
camel.rest.context-path=/api
camel.rest.api-context-path=/api-doc
camel.rest.enable-cors=true

# TigerBeetle Configuration (placeholder)
tigerbeetle.cluster.id=${TIGERBEETLE_CLUSTER_ID:0}
tigerbeetle.addresses=${TIGERBEETLE_ADDRESSES:localhost:3000}

# OpenTelemetry Configuration for Compliance Tracking
quarkus.opentelemetry.enabled=true
quarkus.opentelemetry.tracer.enabled=true
quarkus.opentelemetry.tracer.exporter.otlp.endpoint=${OTEL_EXPORTER_OTLP_ENDPOINT:http://localhost:4317}
quarkus.opentelemetry.tracer.exporter.otlp.headers=${OTEL_EXPORTER_OTLP_HEADERS:}
quarkus.opentelemetry.tracer.exporter.otlp.timeout=10s
quarkus.opentelemetry.tracer.resource-attributes=service.name=fluo-backend,service.version=1.0.0,deployment.environment=${ENV:development}

# Compliance-specific span configuration
quarkus.opentelemetry.tracer.sampler=always_on
quarkus.opentelemetry.tracer.sampler.ratio=1.0
quarkus.opentelemetry.tracer.propagators=tracecontext,baggage

# Span processors for compliance
quarkus.opentelemetry.tracer.span-processors=compliance
compliance.span.processor.enabled=true
compliance.span.processor.frameworks=SOC2,HIPAA,FedRAMP,ISO27001,PCI-DSS

# Health Check Configuration
quarkus.health.enabled=true
quarkus.health.path=/health

# Metrics Configuration
quarkus.micrometer.enabled=true
quarkus.micrometer.export.prometheus.enabled=true
quarkus.micrometer.export.prometheus.path=/metrics

# Logging Configuration
quarkus.log.level=INFO
quarkus.log.category."com.fluo".level=DEBUG
quarkus.log.category."org.apache.camel".level=INFO
quarkus.log.category."com.fluo.security".level=DEBUG
quarkus.log.console.enable=true
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n

# Development Mode Settings
%dev.quarkus.http.port=8080
%dev.quarkus.live-reload.password=changeme
%dev.quarkus.log.level=DEBUG
%dev.workos.sso.enabled=false
%dev.fluo.security.tenant.validation.enabled=false

# Test Mode Settings
%test.quarkus.http.test-port=8081
%test.workos.sso.enabled=false
%test.fluo.security.tenant.validation.enabled=false

# Production Mode Settings
%prod.quarkus.http.port=8080
%prod.quarkus.log.level=INFO
%prod.workos.sso.enabled=true
%prod.fluo.security.tenant.validation.enabled=true

# S3-compatible storage configuration for rules
s3.bucket.name=fluo-rules

# S3 polling configuration (in milliseconds)
s3.poll.delay=30000

# AWS2-S3 Component Configuration
# For AWS S3
camel.component.aws2-s3.region=us-east-1
# camel.component.aws2-s3.access-key=YOUR_ACCESS_KEY
# camel.component.aws2-s3.secret-key=YOUR_SECRET_KEY

# For S3-compatible services like MinIO
# camel.component.aws2-s3.override-endpoint=true
# camel.component.aws2-s3.uri-endpoint-override=http://localhost:9000
# camel.component.aws2-s3.path-style-access=true
# camel.component.aws2-s3.access-key=minioadmin
# camel.component.aws2-s3.secret-key=minioadmin

# Caffeine Cache Configuration
camel.component.caffeine-cache.cache-loader-enabled=false
camel.component.caffeine-cache.cache-writer-enabled=false

# Cache policies for high-performance use cases
# Rule cache - rules rarely change but are frequently accessed
fluo.cache.rules.max-size=1000
fluo.cache.rules.expire-after-write=1h
fluo.cache.rules.expire-after-access=30m

# Session cache - for user sessions and authentication data
fluo.cache.sessions.max-size=10000
fluo.cache.sessions.expire-after-write=24h
fluo.cache.sessions.expire-after-access=2h

# Rule validation cache - for OGNL expression compilation
fluo.cache.rule-validation.max-size=500
fluo.cache.rule-validation.expire-after-write=6h
fluo.cache.rule-validation.expire-after-access=1h